!function(){"use strict";var t=window.ZTA||{};t.config={endpoint:null,siteId:null,debug:!1,trackScrollDepth:!0,trackOutboundLinks:!0,trackFileDownloads:!0,trackFormSubmissions:!0,heartbeatInterval:6e4},t.session={id:null,startTime:null,pageCount:0,isNew:!0,landingPage:null},t.queue={events:[],timer:null,maxSize:10,maxWait:5e3},t.page={startTime:null,maxScrollDepth:0,scrollMilestones:{25:!1,50:!1,75:!1,100:!1}},t.init=function(i,e){e=e||{},t.config.siteId=i,t.config.endpoint=e.endpoint||"https://ztas.io/api/track",t.config.debug=e.debug||!1,t.config.trackScrollDepth=!1!==e.trackScrollDepth,t.config.trackOutboundLinks=!1!==e.trackOutboundLinks,t.config.trackFileDownloads=!1!==e.trackFileDownloads,t.config.trackFormSubmissions=!1!==e.trackFormSubmissions,t.initSession(),t.page.startTime=Date.now(),!1!==e.autoTrack&&t.trackPageView(),e.spa&&t.setupSPATracking(),t.setupEngagementTracking(),t.config.trackScrollDepth&&t.setupScrollTracking(),t.config.trackOutboundLinks&&t.setupOutboundLinkTracking(),t.config.trackFileDownloads&&t.setupFileDownloadTracking(),t.config.trackFormSubmissions&&t.setupFormTracking(),t.setupDeclarativeTracking(),t.setupHeartbeat(),t.setupUnloadFlush(),t.log("Initialized with site ID:",i)},t.setupUnloadFlush=function(){window.addEventListener("pagehide",function(){t.flushQueue()}),document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&t.flushQueue()})},t.initSession=function(){var i=null;try{i=JSON.parse(sessionStorage.getItem("zta_session"))}catch(t){}var e=Date.now();i&&18e5>e-i.lastActivity?(t.session.id=i.id,t.session.startTime=i.startTime,t.session.pageCount=i.pageCount,t.session.landingPage=i.landingPage,t.session.isNew=!1):(t.session.id=t.generateId(),t.session.startTime=e,t.session.pageCount=0,t.session.landingPage=window.location.pathname,t.session.isNew=!0);var n=localStorage.getItem("zta_visitor");n?t.session.isNewVisitor=!1:(n=t.generateId(),localStorage.setItem("zta_visitor",n),t.session.isNewVisitor=!0),t.session.visitorId=n,t.session.pageCount++,t.saveSession()},t.saveSession=function(){try{sessionStorage.setItem("zta_session",JSON.stringify({id:t.session.id,startTime:t.session.startTime,pageCount:t.session.pageCount,landingPage:t.session.landingPage,lastActivity:Date.now()}))}catch(t){}},t.generateId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=16*Math.random()|0;return("x"===t?i:3&i|8).toString(16)})},t.getPerformanceMetrics=function(){if(!window.performance||!window.performance.timing)return null;var t=window.performance.timing,i=t.navigationStart;return{pageLoadTime:t.loadEventEnd>0?t.loadEventEnd-i:null,domContentLoaded:t.domContentLoadedEventEnd>0?t.domContentLoadedEventEnd-i:null,dnsTime:t.domainLookupEnd-t.domainLookupStart,connectTime:t.connectEnd-t.connectStart,ttfb:t.responseStart-t.requestStart,domProcessing:t.domComplete-t.domLoading}},t.getDeviceInfo=function(){var t=navigator.userAgent,i="desktop";/tablet|ipad|playbook|silk/i.test(t)?i="tablet":/mobile|iphone|ipod|android|blackberry|opera mini|iemobile/i.test(t)&&(i="mobile");var e="Unknown",n="";/firefox/i.test(t)?(e="Firefox",n=(t.match(/firefox\/(\d+)/i)||[])[1]||""):/edg/i.test(t)?(e="Edge",n=(t.match(/edg\/(\d+)/i)||[])[1]||""):/chrome/i.test(t)?(e="Chrome",n=(t.match(/chrome\/(\d+)/i)||[])[1]||""):/safari/i.test(t)?(e="Safari",n=(t.match(/version\/(\d+)/i)||[])[1]||""):/msie|trident/i.test(t)&&(e="IE",n=(t.match(/(?:msie |rv:)(\d+)/i)||[])[1]||"");var o="Unknown";return/windows/i.test(t)?o="Windows":/macintosh|mac os x/i.test(t)?o="macOS":/linux/i.test(t)?o="Linux":/android/i.test(t)?o="Android":/iphone|ipad|ipod/i.test(t)&&(o="iOS"),{type:i,browser:e,browserVersion:n,os:o,screenWidth:window.screen.width,screenHeight:window.screen.height,viewportWidth:window.innerWidth,viewportHeight:window.innerHeight,language:navigator.language||navigator.userLanguage||"en",colorDepth:window.screen.colorDepth,pixelRatio:window.devicePixelRatio||1}},t.getUTMParams=function(){var t=new URLSearchParams(window.location.search);return{source:t.get("utm_source")||null,medium:t.get("utm_medium")||null,campaign:t.get("utm_campaign")||null,term:t.get("utm_term")||null,content:t.get("utm_content")||null}},t.getTrafficSource=function(){var t=document.referrer;if(!t)return{type:"direct",source:null};try{var i=new URL(t).hostname.toLowerCase(),e={google:/google\./i,bing:/bing\./i,yahoo:/yahoo\./i,duckduckgo:/duckduckgo\./i,baidu:/baidu\./i,yandex:/yandex\./i};for(var n in e)if(e[n].test(i))return{type:"organic",source:n};var o={facebook:/facebook\.|fb\./i,twitter:/twitter\.|t\.co/i,x:/x\.com/i,linkedin:/linkedin\./i,instagram:/instagram\./i,pinterest:/pinterest\./i,reddit:/reddit\./i,youtube:/youtube\./i,tiktok:/tiktok\./i};for(var a in o)if(o[a].test(i))return{type:"social",source:a};return i===window.location.hostname?{type:"internal",source:i}:{type:"referral",source:i}}catch(i){return{type:"referral",source:t}}},t.trackPageView=function(i){var e=t.getDeviceInfo(),n=t.getUTMParams(),o=t.getTrafficSource(),a={type:"pageview",siteId:t.config.siteId,url:window.location.href,path:window.location.pathname,title:document.title,referrer:document.referrer||null,sessionId:t.session.id,pageCount:t.session.pageCount,landingPage:t.session.landingPage,isNewVisitor:t.session.isNewVisitor,isNewSession:t.session.isNew&&1===t.session.pageCount,device:e,trafficSource:o,utm:n,timestamp:(new Date).toISOString()};if(i)for(var r in i)a[r]=i[r];t.send(a),t.saveSession(),"complete"===document.readyState?t.sendPerformanceMetrics():window.addEventListener("load",function(){setTimeout(function(){t.sendPerformanceMetrics()},100)})},t.sendPerformanceMetrics=function(){var i=t.getPerformanceMetrics();if(i&&null!==i.pageLoadTime){var e={type:"event",siteId:t.config.siteId,sessionId:t.session.id,category:"performance",action:"page_load",label:window.location.pathname,value:i.pageLoadTime,properties:i,path:window.location.pathname,timestamp:(new Date).toISOString()};t.send(e),t.log("Performance metrics sent:",i)}},t.trackEvent=function(i,e,n,o){var a={type:"event",siteId:t.config.siteId,sessionId:t.session.id,category:i,action:e,label:n||null,value:o||null,url:window.location.href,path:window.location.pathname,timestamp:(new Date).toISOString()};t.send(a)},t.track=function(i,e){var n={type:"event",siteId:t.config.siteId,sessionId:t.session.id,category:"custom",action:i,label:(e=e||{}).label||null,value:e.value||e.amount||null,properties:e,url:window.location.href,path:window.location.pathname,timestamp:(new Date).toISOString()};t.send(n),t.log("Tracked event:",i,e)},t.trackEngagement=function(){var i=Math.round((Date.now()-t.page.startTime)/1e3),e=Math.round((Date.now()-t.session.startTime)/1e3),n={type:"engagement",siteId:t.config.siteId,sessionId:t.session.id,path:window.location.pathname,timeOnPage:i,sessionDuration:e,maxScrollDepth:t.page.maxScrollDepth,pageCount:t.session.pageCount,isExitPage:!0,isBounce:1===t.session.pageCount,timestamp:(new Date).toISOString()};t.send(n)},t.setupEngagementTracking=function(){window.addEventListener("pagehide",function(){t.trackEngagement()}),document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&t.trackEngagement()})},t.setupScrollTracking=function(){var i=!1;window.addEventListener("scroll",function(){i||(window.requestAnimationFrame(function(){var e=window.pageYOffset||document.documentElement.scrollTop,n=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)-window.innerHeight,o=n>0?Math.round(e/n*100):100;o>t.page.maxScrollDepth&&(t.page.maxScrollDepth=o),[25,50,75,100].forEach(function(i){i>o||t.page.scrollMilestones[i]||(t.page.scrollMilestones[i]=!0,t.trackEvent("scroll","depth",i+"%",i))}),i=!1}),i=!0)})},t.setupOutboundLinkTracking=function(){document.addEventListener("click",function(i){var e=i.target.closest("a");if(e){var n=e.getAttribute("href");if(n)try{var o=new URL(n,window.location.origin);o.hostname!==window.location.hostname&&t.trackEvent("outbound","click",o.hostname)}catch(t){}}})},t.setupFileDownloadTracking=function(){var i=/\.(pdf|doc|docx|xls|xlsx|ppt|pptx|zip|rar|tar|gz|exe|dmg|mp3|mp4|avi|mov|csv)$/i;document.addEventListener("click",function(e){var n=e.target.closest("a");if(n){var o=n.getAttribute("href");if(o&&i.test(o)){var a=o.split("/").pop().split("?")[0];t.trackEvent("download","file",a)}}})},t.setupFormTracking=function(){document.addEventListener("submit",function(i){var e=i.target;if(e&&"FORM"===e.tagName){var n=e.id||e.name||"",o=e.action||"",a=n;if(!a)try{a=new URL(o,window.location.origin).pathname}catch(t){a="unknown"}var r="form",c=(e.className||"").toLowerCase(),u=n.toLowerCase();/login|signin|sign-in/i.test(u+c)?r="login":/register|signup|sign-up/i.test(u+c)?r="signup":/contact|message/i.test(u+c)?r="contact":/subscribe|newsletter|email/i.test(u+c)?r="subscribe":/search/i.test(u+c)?r="search":/checkout|payment|order/i.test(u+c)&&(r="checkout"),t.trackEvent("form",r,a),t.log("Form submitted:",r,a)}})},t.setupDeclarativeTracking=function(){document.addEventListener("click",function(i){var e=i.target.closest("[data-zta-track]");if(e){var n=e.getAttribute("data-zta-track");if(n){var o={},a=e.getAttribute("data-zta-category"),r=e.getAttribute("data-zta-label"),c=e.getAttribute("data-zta-value");a&&(o.category=a),r&&(o.label=r),c&&(o.value=parseFloat(c)||0),t.track(n,o),t.log("Declarative track:",n,o)}}})},t.setupHeartbeat=function(){setInterval(function(){if("visible"===document.visibilityState){var i={type:"heartbeat",siteId:t.config.siteId,sessionId:t.session.id,path:window.location.pathname,timestamp:(new Date).toISOString()};t.send(i)}},t.config.heartbeatInterval)},t.send=function(i){t.config.siteId?(t.queue.events.push(i),t.log("Queued:",i.type,"(queue size:",t.queue.events.length+")"),t.queue.maxSize>t.queue.events.length?(t.queue.timer&&clearTimeout(t.queue.timer),t.queue.timer=setTimeout(function(){t.flushQueue()},t.queue.maxWait)):t.flushQueue()):t.log("Error: Site ID not set")},t.flushQueue=function(){if(0!==t.queue.events.length){t.queue.timer&&(clearTimeout(t.queue.timer),t.queue.timer=null);var i=t.queue.events;t.queue.events=[],t.log("Flushing",i.length,"events"),t.sendBatch(i)}},t.sendBatch=function(i){fetch(t.config.endpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({batch:!0,siteId:t.config.siteId,events:i}),keepalive:!0}).then(function(){t.log("Batch sent:",i.length,"events")}).catch(function(i){t.log("Batch send error:",i)})},t.setupSPATracking=function(){var i=history.pushState;history.pushState=function(){i.apply(history,arguments),t.onRouteChange()};var e=history.replaceState;history.replaceState=function(){e.apply(history,arguments),t.onRouteChange()},window.addEventListener("popstate",function(){t.onRouteChange()}),t.log("SPA tracking enabled")},t.onRouteChange=function(){t.trackEngagement(),t.page.startTime=Date.now(),t.page.maxScrollDepth=0,t.page.scrollMilestones={25:!1,50:!1,75:!1,100:!1},t.session.pageCount++,t.saveSession(),t.trackPageView()},t.log=function(){},window.ZTA=t;var i,e=document.currentScript||(i=document.getElementsByTagName("script"))[i.length-1];if(e){var n=e.getAttribute("data-site-id"),o="false"!==e.getAttribute("data-auto-track"),a="true"===e.getAttribute("data-spa"),r="true"===e.getAttribute("data-debug"),c="false"!==e.getAttribute("data-track-scroll"),u="false"!==e.getAttribute("data-track-outbound"),s="false"!==e.getAttribute("data-track-downloads"),d="false"!==e.getAttribute("data-track-forms");n&&t.init(n,{autoTrack:o,spa:a,debug:r,trackScrollDepth:c,trackOutboundLinks:u,trackFileDownloads:s,trackFormSubmissions:d})}}();